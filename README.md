## 👮‍♀️ 자금세탁·금융사기 의심거래 탐지 모델 개발
### 사기 계좌 탐지 모델 설계 _(서울대학교 빅데이터 핀테크 전문가 과정 6기, IBK 기업은행 캡스톤 프로젝트)_
 - 핵심 역할 : 데이터 분석 후 설명 변수 설정, 그래프 데이터로 변환, GNN 모델링

 ### 프로젝트 개요  
 - 목적 : 기존의 Rule 기반 자금세탁 및 금융사기 의심거래 탐지 방법의 한계 극복을 위해 사기계좌와 정상계좌의 관계적 특성과 패턴을 파악할 수 있는 네트워크 분석 기반 모형 개발

 - 데이터 : 암호화된 IBK 기업은행 내의 거래내역
   - 데이터 형태 : 각각 14000개, 16000개의 사기 신고 계좌, 정상 계좌를 기준으로 2번까지 거래 내역을 수집
   - Node Feature : 각 계좌로의 출/입금 횟수, 계좌 내 현금성 거래 여부, 활성화 기간
   - Edge Feature : 총 거래 금액, 총 거래 건수, 현금 거래 금액, 거래 지속 기간
   - Graph Label : 사기, 정상 여부 (0, 1)
  
 - 데이터 처리
   - 결측치 처리 : 거래 계좌 명 혹은 적요에 결측치들이 많았고, 간편결제의 경우 추적이 되지 않아 많은 양의 결측치 발생
   - 파생 변수 생성 : Raw Data 내에 많은 Feature들에 대해 이를 이해하고 의미 내포 여부 판단 및 파생 변수 생성에 오랜 기간 소요
   - 데이터 샘플링 : 정상 계좌들에 대한 데이터의 경우 사기 계좌와 비슷한 분포로 추출

 - 모델링
  - DGL Library를 통해 데이터를 그래프 데이터로 변형
  - 많은 GNN 모델 중 계좌 자체의 특성(Node Feature), 계좌 간 거래의 특성(Edge Feature) 모두 사용하는 모델 탐색
  - 다양한 정보들이 있기 때문에 특정 정보에 집중이 가능한 Attention 개념을 가진 GAT 모델 중 Edge에도 Attention을 적용하는 Edge GAT 최종 선정
    
![image](https://github.com/choims12/portfolio/assets/118867938/88626d42-24b9-4405-b56e-fd3ac50fc1dc)


   
- 사용한 모델
   - Edge GAT
   - 하이퍼 파라미터 최적화 : Optuna
  
   
### 프로젝트 결과 
| Model          | Accuracy | Recall | F1 Score |
|----------------|----------|--------|----------|
|Edge GAT           | 0.84     | 0.86   | 0.78      |

  
  
### 배운 점   
- Raw Data에서 Feature들을 선별함에 있어 명확한 기준이 필요함
- Model에 적용할 수 있도록 데이터를 변형하는 과정에서 정보 손실이 일어나지 않아야 함
- 정제된 Data가 아닌 현실에서 발생하는 Data는 매우 방대함, 어떤 목적인지 명확히 파악 후 해당 목적에 어떤 데이터가 필요할까, 어떻게 추출할까에 대한 고민이 매우 중요함
